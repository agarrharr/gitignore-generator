<html>
  <head>
    <script src="//code.jquery.com/jquery-2.1.4.min.js"></script>
  </head>
  <body>
    <label>What type of stuff do you want to ignore?</label>
    <input type="text" id="projectTypeInput"></input>
    <ul id="searchResults"></ul>
    <textarea id="results" cols="100" rows="20"></textarea>
    <script>
    var gitignoreFiles;

    $(document).ready(function() {
      getGitignoreFile();

      $('#projectTypeInput').keyup(function() {
        var value = $(this).val();
        makeGitignoreSearch(value);
      });
    });

    function getGitignoreFile() {
      $.get('https://api.github.com/repos/github/gitignore/contents/', function(d) {
        gitignoreFiles = convertToArrayOfGitignoreFiles(d);
      });
    }

    function convertToArrayOfGitignoreFiles(d) {
      var gitignoreFiles = [];
      for(var i = 0; i < d.length; i += 1) {
        gitignoreFiles.push(d[i].name.split('.')[0]);
      }
      return gitignoreFiles;
    }

    function makeGitignoreSearch(searchTerm) {
      if (result = isValidType(searchTerm)) {
        showResults(result);
      }
    }

    function isValidType(type) {
      for(var i = 0; i < gitignoreFiles.length; i += 1) {
        if (gitignoreFiles[i].toLowerCase() === type.toLowerCase()) {
          return gitignoreFiles[i];
        }
      }
      return false;
    }

    function showResults(type) {
      var $html = $('<li data-type=' + type + '><input type="checkbox"/>' + type + '</li>');
      $html.on('click', addContentToTextArea);
      $('#searchResults').html($html);
    }

    function addContentToTextArea(type) {
      var type = $(this).data('type');
      $.get('https://api.github.com/repos/github/gitignore/contents/' + type + '.gitignore', function(d) {
        var content = atob(d.content);
        appendToTextArea(content);
      });
    }

    function appendToTextArea(content) {
      console.log(content);
      $('#results').val(function(i, val) {
        return (val ? val + '\n\n': '') + content;
      });
    }
    </script>
  </body>
</html>
